Telegram Django Bot Bridge
============================

This library provides a Python interface for creating Telegram Bots. It standardizes coding approach in the best
practice of the web development. The library combines `Django <https://www.djangoproject.com/>`_ and `Python-Telegram-Bot <https://python-telegram-bot.org/>`_.
and provides extra powerful utilities based on this libraries.


Normally, Python-Telegram-Bot gives next opportunities for bot creating:

* Python Interface for communication with Telegram API;
* Web-sevice for get updates from telegram;

and Django:

* Django ORM  (communication with Database);
* Administration panel for management.


Telegram Django Bot Bridge provides next special opportunities:

* using Django Forms;
* using Viewsets (typical action with model (create, update, list, delete));
* using Django localization;
* using function routing like urls routing in Django;
* creating tests;
* creating general menu items with no-coding (through Django Admin Panel);
* extra high-level Bot functions, such as wrapper for send delayed (or scheduled) messages;
* collecting stats from user actions in the bot;
* creating user triggers;
* commonly used utilities.



Install
------------

You can install via ``pip``:

.. code:: shell

    $ pip install telegram_django_bot


Then you can configurate it in your app:


1. Add "telegram_django_bot" to your INSTALLED_APPS setting like this::

    INSTALLED_APPS = [
        ...
        'telegram_django_bot',
    ]



2. Run ``python manage.py migrate`` to create the telegram_django_bot models (checked that the ``AUTH_USER_MODEL`` selected
in settings).


3. Set:

* ``TELEGRAM_ROOT_UTRLCONF`` -  for use django notation in callback (strongly recommended)
* ``TELEGRAM_TOKEN`` - for adding triggers,
* ``TELEGRAM_TEST_USER_IDS`` - for adding tests for your bot,
* Make sure, that ``LANGUAGE_CODE``, ``LANGUAGE_CODE``, ``USE_I18N`` are also used in the library for language localization.


4. Add ``RouterCallbackMessageCommandHandler`` in handlers for using TELEGRAM_ROOT_UTRLCONF ::

    updater = Updater(bot=TG_DJ_Bot(settings.TELEGRAM_TOKEN))
    updater.dispatcher.add_handler(RouterCallbackMessageCommandHandler())


If you start a new project, you could use `Telegram django bot template <https://github.com/alexanderaleskin/telergam_django_bot_template>`_ with preconfigured settings.


Quick start
------------



The key feature of the lib is ``TelegaViewSet`` - class for manage Django ORM model. It is designed in the
similar way as `Django rest framework Viewset <https://www.django-rest-framework.org/api-guide/viewsets/>`_.
TelegaViewSet provides logic to manage ORM model from Telegram through bot interface. By default, TelegaViewSet has
5 methods:

* ``create`` - create a new instance of specified ORM model;
* ``change`` - update instance fields of specified ORM model;
* ``show_elem`` - show fields of the instance and buttons with actions of this instance;
* ``show_list`` - show list of model instance (with pagination);
* ``delete`` - delete the instance


So, if, for example, you have a model of some *request* in your project:

.. code:: python

    from django.db import models

    class Request(models.Model):
        text = models.TextField()
        importance_level = models.PositiveSmallIntegerField()  # for example it will be integer field
        project = models.ForeignKey('Project', on_delete=models.CASCADE)
        tags = models.ManyToManyField('Tags')


The next piece of code gives opportunity for full managing (create, update, show, delete) of this model from Telegram:

.. code:: python

    from telegram_django_bot import forms as td_forms
    from telegram_django_bot.td_viewset import TelegaViewSet


    class RequestForm(td_forms.TelegaModelForm):
        class Meta:
            model = Request
            fields = ['text', 'importance_level', 'project', 'tags']


    class RequestViewSet(TelegaViewSet):
        telega_form = RequestForm
        queryset = Request.objects.all()
        viewset_name = 'Request'


If you need, you can add extra actions to RequestViewSet for managing (see details information below) or change existed functions.
There are several parameters and secondary functions in TelegaViewSet for customizing logic if it is necessary.

In this example, ``TelegaModelForm`` was used. TelegaModelForm is a descendant of Django ModelForm. So, you could use
labels, clean and other parameters and functions for manage logic and displaying.


TelegaViewSet is designed to answer next user actions: clicking buttons and sometimes sending messages. The library imposes
`Django URL notation <https://docs.djangoproject.com/en/4.1/topics/http/urls/>`_ for mapping user actions and TelegaViewSet (or usual handlers).
Usually, for correct mapping you just need to set ``TELEGRAM_ROOT_UTRLCONF`` and use ``RouterCallbackMessageCommandHandler`` in
dispatcher as it is mentioned above in the *Install paragraph*.

For correct mapping *RequestViewSet*  you should write in the TELEGRAM_ROOT_UTRLCONF file something like this:

.. code:: python

    from django.urls import re_path
    from .views import RequestViewSet

    urlpatterns = [
        re_path(r"^rv/", RequestViewSet, name='RequestViewSet'),
    ]

From this point, you can use buttons with callback data "rv/<function_code>" for function calling. For example:

* "rv/cr" - RequestViewSet.create method;
* "rv/sl" - RequestViewSet.show_list;


See this **example** for great understanding.




Deep in details
------------------

–í —ç—Ç–æ–π –≥–ª–∞–≤–µ —Ä–∞–∑–±–µ—Ä–µ–º –∫–∞–∫ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º. –¢–∞–∫ –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–∞—è –∑–∞–¥–∞—á–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–ø–∏—Å–∞–Ω–∏—è –∫–æ–¥–∞ –∏
–ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –±–æ—Ç–∞, —Ç–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–Ω–æ–≥–æ –ª–æ–≥–∏–∫–∏ –±–∞–∑–∏—Ä—É—é—Ç—Å—è –Ω–∞ —Ä–µ—Å—É—Ä—Å–∞—Ö –∏ –ø–∞—Ä–∞–¥–∏–≥–º–∞—Ö
Django <https://www.djangoproject.com/>`_  –∏ `Python-Telegram-Bot <https://python-telegram-bot.org/>`_ . –†–∞–∑–±–µ—Ä–µ–º
–∫–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ `Telegram django bot template <https://github.com/alexanderaleskin/telergam_django_bot_template>`_ .


–¢–∞–∫ –∫–∞–∫ –ë–æ—Ç—ã –≤ –¢–µ–ª–µ–≥—Ä–∞–º–µ —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω—ã –∫–∞–∫ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ –∑–∞–ø—Ä–æ—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Ç–æ –Ω–∞–ø–∏—Å–∞–Ω–∏—è –±–æ—Ç–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è
—Å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –î–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Python-Telegram-Bot Ôπ£
``telegram.ext.Update``:

.. code:: python

    from telegram.ext import Updater

    ...

    def main():
        ...

        updater = Updater(bot=TG_DJ_Bot(TELEGRAM_TOKEN))
        add_handlers(updater)
        updater.start_polling()
        updater.idle()

    if __name__ == '__main__':
        main()


–ö–∞–∫ –∏ —É–∫–∞–∑–∞–Ω–æ –≤ –ø—Ä–∏–º–µ—Ä–µ, –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞ (Update) –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–∫–∞–∑–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–µ—â–µ–π (—Å—Ç–∞–Ω–¥–∞—Ä—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ ``Python-Telegram-Bot``):

1. —ç–∫–∑–µ–º–ª—è—Ä –º–æ–¥–µ–ª–∏ ``telegram.Bot`` —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º API —Ç–æ–∫–µ–Ω–æ–º. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ—Ç–æ–º–æ–∫ –∫–ª–∞—Å—Å–∞ ``telegram.Bot``
``telegram_django_bot.tg_dj_bot.TG_DJ_Bot``, –∫–æ—Ç–æ—Ä—ã–π –∏–º–µ–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ (–∫ –Ω–µ–º—É –≤–µ—Ä–Ω–µ–º—Å—è –ø–æ–∑–∂–µ);
2. –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è –≤ –æ—Ç–≤–µ—Ç –Ω–∞ –∑–∞–ø—Ä–æ—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.


–í –ø—Ä–∏–º–µ—Ä–µ –ø–µ—Ä–µ—á–µ–Ω—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ —Ñ—É–Ω–∫—Ü–∏–∏ ``add_handlers``:



.. code:: python

    from telegram_django_bot.routing import RouterCallbackMessageCommandHandler

    ...

    def add_handlers(updater: Updater):
        dp = updater.dispatcher
        dp.add_handler(RouterCallbackMessageCommandHandler())


–í –ø—Ä–∏–º–µ—Ä–µ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è 1 —Å—É–ø–µ—Ä –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ ``RouterCallbackMessageCommandHandler``, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–∏—Å–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
–≤ —Å—Ç–∏–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ —Å—Å—ã–ª–æ–∫ –≤ ``Django``. ``RouterCallbackMessageCommandHandler`` –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å
—Å–æ–æ–±—â–µ–Ω–∏—è, –∫–æ–º–∞–Ω–¥—ã –ø–æ–ª—å–∑–æ–≤–∞–µ—Ç–µ–ª–µ–π –∏ –Ω–∞–∂–∞—Ç–∏—è –Ω–∞ –∫–Ω–æ–ø–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏. –¢–æ –µ—Å—Ç—å –∑–∞–º–µ–Ω—è–µ—Ç —Å–æ–±–æ–π —Ö–µ–Ω–¥–ª–µ—Ä—ã
``MessageHandler, CommandHandler, CallbackQueryHandler`` . –¢–∞–∫ –∫–∞–∫ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ ``Telegram Django Bot Bridge`` —è–≤–ª—è–µ—Ç—Å—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º
–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π, —Ç–æ –æ–Ω–∞ –Ω–µ –∑–∞–ø—Ä–µ—â–∞–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –∫–∞—á–µ—Å—Ç–≤–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ ``Python-Telegram-Bot``
(–∏–Ω–æ–≥–¥–∞ —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ—Ç–≤–µ—Ç—ã –Ω–∞ –æ–ø—Ä–æ—Å—ã (–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å PollAnswerHandler)).

`Django –Ω–æ—Ç–∞—Ü–∏—è <https://docs.djangoproject.com/en/4.1/topics/http/urls/>`_ –æ–ø–∏—Å–∞–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ñ–∞–π–ª–µ –∏–ª–∏ —Ñ–∞–π–ª–∞—Ö –æ–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –ø—É—Ç–∏ –¥–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤.
–ö–∞–∫ –∏ –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–µ ``Django`` –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞ —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≥–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª (–∫–æ—Ä–µ–Ω—å), –≥–¥–µ —Ö—Ä–∞–Ω—è—Ç—å—Å—è –ø—É—Ç–∏ –¥–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∏–ª–∏ –ø—É—Ç–∏ –∫ –æ—Ç–¥–µ–ª—å–Ω—ã–º –≥—Ä—É–ø–ø–∞–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤.
–î–ª—è —É–∫–∞–∑–∞–Ω–∞–Ω–∏—è –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª—É –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞—Ç—Ä–∏–±—É—Ç ``TELEGRAM_ROOT_UTRLCONF``. –í —à–∞–±–ª–æ–Ω–µ-–ø—Ä–∏–º–µ—Ä–µ –∏–º–µ–µ–º —Å–ª–µ–¥—É—é—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:


``bot_conf.settings.py``:

.. code:: python

    TELEGRAM_ROOT_UTRLCONF = 'bot_conf.utrls'


``bot_conf.utrls.py``:

.. code:: python

    from django.urls import re_path, include

    urlpatterns = [
        re_path('', include(('base.utrls', 'base'), namespace='base')),
    ]


–¢–æ –µ—Å—Ç—å, –≤ —Ñ–∞–π–ª–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ 1 –≥—Ä—É–ø–ø–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ (–∫–æ—Ç–æ—Ä–∞—è –Ω–∞ –∏–¥–µ–π–Ω–Ω–æ–º —É—Ä–æ–≤–Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é ``base``). –ú–æ–∂–Ω–æ
–¥–æ–±–∞–≤–ª—è—Ç—å –∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≥—Ä—É–ø–ø, —Ç–∞–∫–æ–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —É–¥–æ–±–Ω—ã–º, –µ—Å–ª–∏ –≤—ã —Å–æ–∑–¥–∞–µ—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–∞–ø–æ–∫ (–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π) –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–¥–∞. –ö–∞–∫ –≤–∏–¥–Ω–æ –∏–∑ –∏–º–ø–æ—Ä—Ç–æ–≤
–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–∏ ``Django`` –±–µ–∑ –∫–∞–∫–æ–≥–æ –ª–∏–±–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è.

–í —Å–∞–º–æ–º —Ñ–∞–π–ª–µ —Å –≥—Ä—É–ø–ø–æ–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ ``base.utrls.py`` –∏–º–µ–µ–º —Å–ª–µ–¥—É—é—â–∏–π –∫–æ–¥:


.. code:: python

    from django.urls import re_path
    from django.conf import settings

    from .views import start, BotMenuElemViewSet, UserViewSet, some_debug_func


    urlpatterns = [
        re_path('start', start, name='start'),
        re_path('main_menu', start, name='start'),

        re_path('sb/', BotMenuElemViewSet, name='BotMenuElemViewSet'),
        re_path('us/', UserViewSet, name='UserViewSet'),
    ]


    if settings.DEBUG:
        urlpatterns += [
            re_path('some_debug_func', some_debug_func, name='some_debug_func'),
        ]

–ö–∞–∫ –≤–∏–¥–Ω–æ, –∑–¥–µ—Å—å —É–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —É–∂–µ –∫–æ–Ω–µ—á–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –æ–ø–∏—Å–∞–Ω—ã –≤ —Ñ–∞–π–ª–µ ``base.views.py``. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –µ—Å–ª–∏
–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –±–æ—Ç–µ –ø–∏—à–µ—Ç –∫–æ–º–∞–Ω–¥—É ``/start``, —Ç–æ ``Updater`` –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –¥–µ–π—Å—Ç–≤–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –∏–∑ –Ω–∞–±–æ—Ä–∞ —Å–≤–æ–∏—Ö
–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –≤—ã–±–∏—Ä–∞–µ—Ç –ø–æ–¥—Ö–æ–¥—è—â–∏–π –ø–æ–¥ –∑–∞–ø—Ä–æ—Å ``RouterCallbackMessageCommandHandler``, –∫–æ—Ç–æ—Ä—ã–π –≤ —Å–≤–æ—é –æ—á–µ—Ä–µ–¥—å —Å—Ä–µ–¥–∏
``utrls`` –Ω–∞—Ö–æ–¥–∏—Ç –ø–æ–¥—Ö–æ–¥—è—â–∏–π –ø—É—Ç—å ``'' + 'start'`` –∏ –ø–µ—Ä–µ–¥–∞–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ start.

–¢–∞–∫–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å —á–∞—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –≤ –º–æ–¥—É–ª–∏ –∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±—ã—Å—Ç—Ä–æ –ø–æ–¥–∫–ª—é—á–∞—Ç—å –∏–ª–∏
–∏–∑–º–µ–Ω—è—Ç—å –∏—Ö, –ø—Ä–∏ —ç—Ç–æ –Ω–µ –±–æ—è—Ç—Å—è, —á—Ç–æ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å –ø—É—Ç–∞–Ω–∏—Ü–∞ –∫–∞–∫–æ–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –Ω—É–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å, –∫–∞–∫ —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å, –µ—Å–ª–∏ –≤—Å–µ
–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –ø–æ–¥—Ç—è–≥–∏–≤–∞–ª–∏ –≤ –æ–¥–Ω–æ –º–µ—Å—Ç–æ –∏–∑ —Ä–∞–∑–Ω—ã—Ö –º–æ–¥—É–ª–µ–π –∫–∞–∫ —ç—Ç–æ —Ç—Ä–µ–±—É–µ—Ç ``Python-Telegram-Bot``.

–í –ø—Ä–∏–º–µ—Ä–µ, –∫—Ä–æ–º–µ —Ñ—É–Ω–∫—Ü–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∫–∞–∫ ``def start`` –∏ ``def some_debug_func``, —Ç–∞–∫–∂–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è ViewSets, –∫–æ—Ç–æ—Ä—ã–µ
—è–≤–ª—è—é—Ç—Å—è –∞–≥–≥—Ä–µ–≥–∞—Ç–æ—Ä–∞–º–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π. –ö–æ–Ω—Ü–µ–ø—Ç ViewSets –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —á–∞—Å—Ç–æ –Ω–∞–¥–æ –ø—Ä–∏–º–µ–Ω—è—Ç—å
–æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, —Ç–∞–∫–∏–µ –∫–∞–∫ —Å–æ–∑–¥–∞—Ç—å, –∏–∑–º–µ–Ω–∏—Ç—å, –ø–æ–∫–∞–∑–∞—Ç—å, —É–¥–∞–ª–∏—Ç—å –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö. –í –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è
—Ç–∞–∫–∏—Ö —Ü–µ–ª–µ–π —Å–æ–∑–¥–∞–Ω –∫–ª–∞—Å—Å ``telegram_django_bot.td_viewset.TelegaViewSet``, –∫–æ—Ç–æ—Ä—ã–π –≤ –∫–∞—á–µ—Å—Ç–≤–µ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑—É–µ—Ç
Django ORM –º–æ–¥–µ–ª—å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö. ``TelegaViewSet`` –∏–º–µ–µ—Ç 5 —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–æ–¥–µ–ª—å—é:



========= ======== ===========================
 –ú–µ—Ç–æ–¥     UTRL      –û–ø–∏—Å–∞–Ω–∏–µ
--------- -------- ---------------------------
create     cr       –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏
change     up       –ò–∑–º–µ–Ω–µ–Ω–∏—è –∞—Ç—Ä–∏–±—É—Ç–æ–≤
delete     de       –£–¥–∞–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
show_elem  se       –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
show_list  sl       –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –º–æ–¥–µ–ª–µ–π
========= ======== ===========================

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –µ—Å–ª–∏ –º—ã —Ö–æ—Ç–∏–º –≤—ã–∑–≤–∞—Ç—å –º–µ—Ç–æ–¥ ``BotMenuElemViewSet.create`` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–∞ –Ω–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
—Å–ª–µ–¥—É—é—â–∏–π –ø—É—Ç—å 'sb/cr' Ôπ£ –ø–æ –ø–µ—Ä–≤–æ–π —á–∞—Å—Ç–∏ –ø—É—Ç–∏ 'sb/' ``RouterCallbackMessageCommandHandler`` –ø–µ—Ä–µ–¥–∞—Å—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
–∫–ª–∞—Å—Å—É ``BotMenuElemViewSet``, –∞ –∏–º–µ–Ω–Ω–æ –º–µ—Ç–æ–¥—É ``TelegaViewSet.dispatch``, –∫–æ—Ç–æ—Ä—ã–π –≤–Ω—É—Ç—Ä–∏ —Å–µ–±—è –ø–æ –≤—Ç–æ—Ä–æ–π —á–∞—Å—Ç–∏ –ø—É—Ç–∏
``cr`` –ø–æ–π–º–µ—Ç, —á—Ç–æ –Ω—É–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å –º–µ—Ç–æ–¥ ``create``.

–ü–æ–¥–≤–æ–¥—è –∏—Ç–æ–≥ –ø–æ —Å—Ö–µ–º–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—É—Ç–µ–π –¥–ª—è –≤—ã–∑–æ–≤–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤, –∏–º–µ–µ–º —Å–ª–µ–¥—É—é—â–µ–µ:

1. –í –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–∏–µ–º—â–∏–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç –¢–µ–ª–µ–≥—Ä–∞–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ``telegram.ext.Update``;
2. –í –∫–∞—á–µ—Å—Ç–≤–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ ``Python-Telegram-Bot``. –î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
—Å—Ö–µ–º—ã —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—É—Ç–µ–π Django –∏ —É–¥–æ–±–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è ``TelegaViewSet`` –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ``RouterCallbackMessageCommandHandler``.
3. ``TelegaViewSet`` –∞–≥–≥—Ä–µ–≥–∏—Ä—É–µ—Ç –≤ —Å–µ–±–µ –Ω–∞–±–æ—Ä —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥,
—Å–≤—è–∑–∞–Ω–Ω—ã–π —Å –æ–¥–Ω–∏–º —Ç–∏–ø–æ–º –¥–∞–Ω–Ω—ã—Ö –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ.



TelegaViewSet features
~~~~~~~~~~~~~~~~~~~~~~~~

–ö–∞–∫ —Ä–∞–Ω–Ω–µ–µ —É–ø–æ–º—è–Ω—É—Ç–æ, TelegaViewSet —Å–æ–¥–µ—Ä–∂–∏—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.
–ó–∞ —Å—á–µ—Ç —Ç–∞–∫–∏—Ö —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –≤ –ø—Ä–∏–º–µ—Ä–µ –æ–ø–∏—Å–∞—Ç—å –ª–æ–≥–∏–∫—É ``BotMenuElemViewSet`` –≤ 40
—Å—Ç—Ä–æ—á–∫–∞—Ö –∫–æ–¥–∞, –ø—Ä–∏ —ç—Ç–æ–º –µ—â–µ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—É—é –∫–∞—Å—Ç–æ–º–∏–∑–∞—é—Ç—Å—è –¥–ª—è –∫—Ä–∞—Å–∏–≤–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è.


–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –∫–ª–∞—Å—Å–∞ TelegaViewSet –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ—Ç –Ω–µ–≥–æ –Ω–∞—Å–ª–µ–¥–æ–≤–∞—Ç—å—Å—è, –∫–∞–∫ –Ω–∞–ø—Ä–∏–º–µ—Ä, —ç—Ç–æ —Å–¥–µ–ª–∞–Ω–æ
–≤ —à–∞–±–ª–æ–Ω–µ —Å BotMenuElemViewSet:


.. code:: python

    from telegram_django_bot.td_viewset import TelegaViewSet

    class BotMenuElemViewSet(TelegaViewSet):


–î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –∫–∞—Å—Ç–æ–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å ViewSet –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–∫–∞–∑–∞—Ç—å 3 –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –∞—Ç—Ä–∏–±—É—Ç–∞:
1. ``viewset_name``  -  –∏–º—è –∫–ª–∞—Å—Å–∞, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –±–æ—Ç–∞
2. ``telega_form``  - —Ñ–æ—Ä–º–∞ –¥–∞–Ω–Ω—ã—Ö, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —É–∫–∞–∑–∞–Ω–∏—è –∫–∞–∫–∏–µ –ø–æ–ª—è ORM –º–æ–¥–µ–ª–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–æ viewset;
3. ``queryset`` - –±–∞–∑–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –º–æ–¥–µ–ª–∏.

–í —à–∞–±–ª–æ–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è:

.. code:: python

    from telegram_django_bot import forms as td_forms
    from telegram_django_bot.models import BotMenuElem

    class BotMenuElemForm(td_forms.TelegaModelForm):
        form_name = _("Menu elem")

        class Meta:
            model = BotMenuElem
            fields = ['command', "is_visable", "callbacks_db", "message", "buttons_db"]

    class BotMenuElemViewSet(TelegaViewSet):
        viewset_name = 'BotMenuElem'
        telega_form = BotMenuElemForm
        queryset = BotMenuElem.objects.all()


–≥–¥–µ ``BotMenuElemForm`` —è–≤–ª—è–µ—Ç—Å—è –ø–æ—Ç–æ–º–∫–æ–º –∫–ª–∞—Å—Å–∞ ``Django ModelFrom``, –ø–æ—ç—Ç–æ–º—É –∏–º–µ–µ—Ç —Å—Ö–æ–∂—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ —Å–ø–æ—Å–æ–±—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏–∏.
`` form_name `` -- –æ–±–æ–∑–Ω–∞—á–∞–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–æ—Ä–º—ã –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –¢–µ–ª–µ–≥—Ä–∞–º–º–∞.



TelegaViewSet –∏–º–µ–µ—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–Ω–æ–≥–æ –æ–±—â–µ–≥–æ —Å –∞–Ω–∞–ª–æ–≥–∞–º–∏ Viewset, –∑–∞—Ç–æ—á–µ–Ω–Ω—ã—Ö –ø–æ–¥ WEB-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É (–Ω–∞–ø—Ä–∏–º–µ—Ä,
`django-rest-framework viewsets <https://www.django-rest-framework.org/api-guide/viewsets/>`_ ). –û–¥–Ω–∞–∫–æ –≤ —Ä–∞–º–∫–∞—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –¢–µ–ª–µ–≥—Ä–∞–º –±–æ—Ç–æ–≤ TelegaViewSet
–∏–º–µ–µ—Ç —Ä—è–¥ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π:

1. –û—Å–æ–±—ã–π —Å–ø–æ—Å–æ–± —Å–æ–∑–¥–∞–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤;
2. –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ –±–æ—Ç–∞—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω –∏ —á–∞—â–µ –≤—Å–µ–≥–æ —Å–≤–æ–¥–∏—Ç—å—Å—è –∫ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—é —Ç–µ–∫—Å—Ç–∞ –∏ –∫–Ω–æ–ø–æ–∫, –ø–æ—ç—Ç–æ–º—É viewset
–∫—Ä–æ–º–µ –±–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∏, –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è –∫–æ–Ω—Å—Ç—Ä—É–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö;


–§–æ—Ä–º—ã
************


–¢–∞–∫ –∫–∞–∫ –≤ –¢–µ–ª–µ–≥—Ä–∞–º –Ω–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π —Å–æ–∑–¥–∞—Ç—å —Ñ–æ—Ä–º—ã (–≤ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–º –í–µ–± –ø–æ–Ω–∏–º–∞–Ω–∏–∏) –∏ –æ–±—â–µ–Ω–∏–µ –º–µ–∂–¥—É –±–æ—Ç–æ–º –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ —á–∞—Ç–µ, —Ç–æ
–Ω–∞–∏–±–æ–ª–µ–µ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ –ø–æ–Ω—è—Ç–Ω—ã–º —Ä–µ—à–µ–Ω–∏–µ–º –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è —Ñ–æ—Ä–º—ã (—Å–æ–∑–¥–∞–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–∞) —è–≤–ª—è–µ—Ç—Å—è –ø–æ —ç–ª–µ–º–µ–Ω—Ç–Ω–æ–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º—ã,
–∫–æ–≥–¥–∞ —Å–Ω–∞—á–∞–ª–∞ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–µ—Ä–≤—ã–π —ç–ª–µ–º–µ–Ω—Ç —Ñ–æ—Ä–º—ã, –∑–∞—Ç–µ–º –≤—Ç–æ—Ä–æ–π –∏ —Ç–¥. –ü—Ä–∏ —ç—Ç–æ–º –≤ –∫–∞–∫–æ–º-—Ç–æ –≤—Ä–µ–º–µ–Ω–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –∑–∞–ø–æ–º–∏–Ω–∞—Ç—å
—É–∫–∞–∑–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –≤ –∫–æ–Ω—Ü–µ —Å–æ–∑–¥–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç –∏–∑ —Ñ–æ—Ä–º—ã. ``TelegaModelForm`` –∏ ``TelegaForm`` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∫–∞–∫ —Ä–∞–∑
—Ç–∞–∫–∏–º —Å–ø–æ—Å–æ–±–æ–º, —á—Ç–æ–±—ã –≤–∑—è—Ç—å —ç—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞ —Å–µ–±—è. –û—Ç–ª–∏—á–∏–µ —ç—Ç–∏—Ö –∫–ª–∞—Å—Å–æ–≤ –æ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö Django –∫–ª–∞—Å—Å–æ–≤ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –∏–º–µ–Ω–Ω–æ
–≤ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å–ø–æ—Å–æ–±–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª–µ–π —Ñ–æ—Ä–º—ã, –≤ –æ—Å—Ç–∞–ª—å–Ω–æ–º –æ–Ω–∏ –Ω–µ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –æ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Ñ–æ—Ä–º.

``TelegaModelForm`` –∏ ``TelegaForm`` –∫–∞–∫ –ø–æ—Ç–æ–º–∫–∏ Django ``ModelForm`` –∏ ``Form`` –∏–º–µ–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ
–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —á–∞—Å—Ç–æ –Ω—É–∂–Ω–æ –∫–∞—Å—Ç–æ–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å :
1. –§—É–Ω–∫—Ü–∏—è clean –∏ –¥—Ä—É–≥–∏–µ `—Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ñ–æ—Ä–º <https://docs.djangoproject.com/en/4.1/ref/forms/validation/>`_
2. ``labels`` - –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–æ–ª–µ–π;
3. ``forms.HiddenInput`` - –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏–µ —Å–∫—Ä—ã—Ç—ã—Ö –ø–æ–ª–µ–π (—Å–∫—Ä—ã–≤–∞–Ω–∏–µ –ø–æ–ª–µ–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Ö –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é,
–ø—Ä–∏ —ç—Ç–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ö –∏–ª–∏ –≤ ``TelegaViewSet``)



``TelegaViewSet`` —Ä–∞—Å—Å—á–∏—Ç–∞–Ω –Ω–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –ø–æ—Ç–æ–º–∫–∞–º–∏ –∫–ª–∞—Å—Å–∞ ``TelegaModelForm`` –∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ñ–æ—Ä–º—ã –∫–∞–∫ —Å –ø—Ä–æ—Å—Ç—ã–º–∏ –ø–æ–ª—è–º–∏ ``CharField, IntegerField`` —Ç–∞–∫ –∏ —Å ``ForeignKey, ManyToManyField``. –ü—Ä–∏ —ç—Ç–æ–º,
–ø—Ä–∏–Ω–∏–º–∞—è –≤–æ –≤–Ω–∏–º–∞–Ω–∏—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –æ–±—â–µ–Ω–∏—è —Å –±–æ—Ç–æ–º –≤ –¢–µ–ª–µ–≥—Ä–∞–º–º–µ, –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —É–¥–æ–±—Å—Ç–≤–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è —Ñ–æ—Ä–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
–≤ –∫–ª–∞—Å—Å–µ ``TelegaViewSet`` –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ª–æ–≤–∞—Ä—å ``prechoice_fields_values``, –∫–æ—Ç–æ—Ä—ã–π —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç —Å–ø–∏—Å–æ–∫ —á–∞—Å—Ç–æ
–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –ø–æ–ª–µ–π —Ñ–æ—Ä–º—ã. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –≤—ã–±–∏—Ä–∞—Ç—å –Ω—É–∂–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ –∫–Ω–æ–ø–æ–∫, –∞ –Ω–µ
–≤–≤–æ–¥–∏—Ç—å —Ç–µ–∫—Å—Ç –∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –≤—Ä—É—á–Ω—É—é. –í —à–∞–±–ª–æ–Ω–µ –µ—Å—Ç—å –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —ç—Ç–æ–≥–æ –ø–æ–ª—è:


.. code:: python

    class BotMenuElemViewSet(TelegaViewSet):
        ...

        prechoice_fields_values = {
            'is_visable': (
                (True, 'üëÅ Visable'),
                (False, 'üö´ Disabled'),
            )
        }

–í –¥–∞–Ω–Ω–æ–º, —Å–ª—É—á–∞–µ –¥–ª—è –±—É–ª–µ–≤—Å–∫–æ–≥–æ –ø–æ–ª—è ``is_visable`` —É–∫–∞–∑–∞–Ω—ã 2 –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –≤—ã–±–æ—Ä–∞ –ø—Ä–∞–≤–¥–∞ –∏ –ª–æ–∂—å —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –∫–∞–∫ –æ–Ω–∏
–æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º. –ò–Ω–æ–≥–¥–∞ —Å–ø–∏—Å–æ–∫ –∑–Ω–∞—á–µ–Ω–∏–π –Ω–∞–¥–æ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –¥–∏–Ω–∞–º–∏—á–Ω–æ, –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å
``prechoice_fields_values`` –∫–∞–∫ ``@property`` —Ñ—É–Ω–∫—Ü–∏—é.


–û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ TelegaViewSet
************************************************

–û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–π –∫–ª–∞—Å—Å–∞, –∫–æ—Ç–æ—Ä–∞—è –ø–æ –∑–∞–ø—Ä–æ—Å—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤—ã–±–∏—Ä–∞—é—Ç —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –≤—ã–∑–æ–≤–∞, —è–≤–ª—è–µ—Ç—Å—è ``TelegaViewSet.dispatch``.
–†–∞–∑–±–µ—Ä–µ–º –µ–µ –ª–æ–≥–∏–∫—É –ø–æ–¥—Ä–æ–±–Ω–µ–µ:

.. code:: python

    def dispatch(self, bot, update, user):

        self.bot = bot
        self.update = update
        self.user = user

        if update.callback_query:
            utrl = update.callback_query.data
        else:
            utrl = user.current_utrl

        self.utrl = utrl

        if settings.DEBUG:
            logging.info(f'utrl: {utrl}')

        utrl_args = self.get_utrl_params(re.sub(f'^{self.prefix}', '', self.utrl))
        if self.has_permissions(bot, update, user, utrl_args):
            chat_action, chat_action_args = self.viewset_routing[utrl_args[0]](*utrl_args[1:])
        else:
            chat_action = self.CHAT_ACTION_MESSAGE
            message = _('Sorry, you do not have permissions to this action.')
            buttons = []
            chat_action_args = (message, buttons)

        res = self.send_answer(chat_action, chat_action_args, utrl)

        utrl_path = utrl.split(self.ARGS_SEPARATOR_SYMBOL)[0]   # log without params as to much varients
        add_log_action(self.user.id, utrl_path)
        return res


–ö–∞–∫ –∏ –æ–±—ã—á–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ñ—É–Ω–∫—Ü–∏—è –Ω–∞ –≤—Ö–æ–¥ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç 3 –∞—Ä–≥—É–º–µ–Ω—Ç–∞: bot, update, user. –ü–æ—Å–ª–µ –∏—Ö —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç
–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –ø—É—Ç–∏. –û–Ω –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ª–∏–±–æ –ø–æ –Ω–∞–∂–∞—Ç–∏—é –∫–Ω–æ–ø–∫–∏ –≤ –±–æ—Ç–µ (–∑–Ω–∞—á–µ–Ω–∏–µ ``callback_data`` –∫–Ω–æ–ø–∫–∏), –ª–∏–±–æ
–º–æ–∂–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –≤ –∞—Ç—Ä–∏–±—É—Ç–µ —é–∑–µ—Ä–∞ ``user.current_utrl``. –í—Ç–æ—Ä–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –≤–æ–∑–º–æ–∂–µ–Ω, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Ä—É—á–Ω—É—é –∑–∞–Ω–æ—Å–∏—Ç
–∫–∞–∫—É—é-—Ç–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é (–Ω–∞–ø—Ä–∏–º–µ—Ä –∑–∞–ø–æ–ª–Ω–∏–ª —Ç–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ –≤ —Ñ–æ—Ä–º–µ). –ü–æ—Å–ª–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∏–∑ –ø—É—Ç–∏
–¥–ª—è –≤—ã–∑–æ–≤–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏. –•—Ä–∞–Ω–µ–Ω–∏–µ –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏ –≤ –ø—É—Ç–∏ —Å—Ö–æ–∂–µ —Å —Ä–∞–±–æ—Ç–æ–π ``sys.argv``. –¢–∞–∫,
–Ω–∞–ø—Ä–∏–º–µ—Ä —Å—Ç—Ä–æ–∫–∞ ``"sl&1&20"`` –±—É–¥–µ—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∞ –≤ —Å–ø–∏—Å–æ–∫ ``['sl', '1', '20']``. –ó–Ω–∞–∫ —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –º–µ–∂–¥—É –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏
–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤—ã–±—Ä–∞–Ω ``&`` –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–∑–º–µ–Ω–µ–Ω —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é ``TelegaViewSet.ARGS_SEPARATOR_SYMBOL`` .

–ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ ``TelegaViewSet`` —Å–∫–æ—Ä–µ–π –≤—Å–µ–≥–æ –≤–∞–º –Ω–µ –ø—Ä–∏–¥–µ—Ç—å—Å—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å–æ —Å—Ç—Ä–æ–∫–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –Ω–∞ –ø—Ä—è–º—É—é, —Ç–∞–∫
–∫–∞–∫  ``dispatch`` –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç —Å—Ç—Ä–æ–∫—É –≤ –∞—Ä–≥—É–º–µ–Ω—Ç—ã, –∞ —Å–æ–∑–¥–∞—Ç—å —Å—Ç—Ä–æ–∫—É –¥–ª—è ``callback_data`` –∫–Ω–æ–ø–∫–∏ c –≤—ã–∑–æ–≤–æ–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞ –∏ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ —Å—Ç–æ–∏—Ç –∏—Å–æ–ø–ª—å–∑–æ–≤–∞—Ç—å
``TelegaViewSet.gm_callback_data``. –í —Å–ª—É—á–∞–µ, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –±–æ–ª–µ–µ –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏ —Ñ—É–Ω–∫—Ü–∏–π, —Ç–æ
–º–æ–∂–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ñ—É–Ω–∫—Ü–∏—è–º–∏ ``construct_utrl`` –∏ ``get_utrl_params``.

–ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ utrl_args –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –≤—ã–±–æ—Ä –∏ –≤—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏. –ü–µ—Ä–≤—ã–π
–∞—Ä–≥—É–º–µ–Ω—Ç utrl_args —è–≤–ª—è–µ—Ç—Å—è —Å–≤–æ–µ–≥–æ —Ä–æ–¥–∞ –∫–æ—Ä–æ—Ç–∫–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º —Ñ—É–Ω–∫—Ü–∏–∏. –í—Å–µ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –∫–∞–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
–≤ —Ñ—É–Ω–∫—Ü–∏—é. –í–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞—è –±–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∞ –∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–≤–µ—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é. –ù–∞ –≤—ã—Ö–æ–¥–µ
–ª—é–±–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Ç–∏–ø –¥–µ–π—Å—Ç–≤–∏—è ``chat_action`` –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫ —ç—Ç–æ–º—É –¥–µ–π—Å—Ç–≤–∏—é ``chat_action_args``. –ü–æ
—É–º–æ–ª—á–∞–Ω–∏ –≤ –∫–ª–∞—Å—Å–µ ``TelegaViewSet`` –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ 1 –¥–µ–π—Å—Ç–≤–∏–µ Ôπ£ ``CHAT_ACTION_MESSAGE``, –∫–æ—Ç–æ—Ä–æ–µ –æ–±–æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
–±—É–¥–µ—Ç –≤–æ–∑–≤—Ä–∞—â–µ–Ω–æ —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (–≤–æ–∑–º–æ–∂–Ω–æ —Å –∫–Ω–æ–ø–∫–∞–º–∏). –ê—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏ –∫ —Ç–µ–º—É –¥–µ–π—Å—Ç–≤–∏—é —è–≤–ª—è—é—Ç—Å—è —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∏ —Å–ø–∏—Å–æ–∫ –∫–Ω–æ–ø–æ–∫.


–ü–æ—Å–ª–µ –æ—Ç—Ä–∞–±–æ—Ç–∫–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–≤–µ—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é ``send_answer`` –∏ –ª–æ–≥–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.


–í –∫–∞—á–µ—Å—Ç–≤–µ –º–µ—Ç–æ–¥ –¥–ª—è –≤—ã–∑–æ–≤–∞ –≤ ``viewset_routing`` –≤—ã—Å—Ç—É–ø–∞—é—Ç –º–µ—Ç–æ–¥—ã ``create, update, delete, show_elem, show_list``.
–¢–∞–∫–∂–µ –º–æ–≥—É—Ç –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω—ã —Å–≤–æ–∏ –º–µ—Ç–æ–¥—ã. –ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —á—Ç–æ —Ö–æ—Ç–∏–º –¥–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ ``def super_method(self, *args)``, —Ç–æ–≥–¥–∞
–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤ –∫–ª–∞—Å—Å–µ –¥–æ–±–∞–≤–∏—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ —Å—Ç—Ä–æ–∫–∏:

.. code:: python

    class SomeViewSetClass(TelegaViewSet):
        ...

        actions = ['create', 'change', 'delete', 'show_elem', 'show_list', 'super_method']

        command_routing_super_method = 'sm'


        def super_method(self, *args):
            ...


–ì–¥–µ actions –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤, –∞ command_routing_<method> –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø—É—Ç—å (url) –º–µ—Ç–æ–¥–∞.

–ö–∞–∫ –æ—Ç–º–µ—á–∞–ª–æ—Å—å –≤—ã—à–µ –º–µ—Ç–æ–¥ ``dispatch`` —Å–æ–≤–µ—Ä—à–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –∑–∞ —Å—á–µ—Ç –≤—ã–∑–æ–≤–∞ –º–µ—Ç–æ–¥–∞ ``has_permissions``.
–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –∑–∞ —Å—á–µ—Ç –∫–ª–∞—Å—Å–æ–≤ —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –≤ ``permission_classes`` –∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–ª–∞—Å—Å
``AllowAny``:

.. code:: python

    class TelegaViewSet:
        permission_classes = [AllowAny]



–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã TelegaViewSet
************************************************

–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –æ–ø–∏—Å–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∫–ª–∞—Å—Å–∞, –∫–æ—Ç–æ—Ä—ã–µ —É–ø—Ä–æ—â–∞–µ—Ç –Ω–∞–ø–∏—Å–∞–Ω–∏–µ –∫–æ–¥–∞:

1. –í–Ω–µ—à–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä—ã
2. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö;
3. –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö;
4. –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –±–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∏;


–í–Ω–µ—à–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä—ã
+++++++++++++++++++++

–î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —á–∞—Å—Ç–æ –≤–æ–∑–Ω–∏–∫–∞—é—Ç —Å–∏—Ç—É–∞—Ü–∏–∏, –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ —Å–æ –≤—Å–µ–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ —Ç–∞–±–ª–∏—Ü—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, –∞ —Å –∫–∞–∫–æ–π-—Ç–æ
–≥—Ä—É–ø–ø–æ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≥—Ä—É–ø–ø–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º –≤–Ω–µ—à–Ω–∏–º –∫–ª—é—á–æ–º). –î–ª—è —Ç–∞–∫–∏—Ö —Ü–µ–ª–µ–π —Å—Ç–æ–∏—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫ ``foreign_filters``,
–∫–æ—Ç–æ—Ä—ã–π —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ —Å–µ–±–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–∏ –≤—ã–∑–æ–≤–µ –º–µ—Ç–æ–¥–∞. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –≤ —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å
–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∞—Ä–≥—É–º–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —Ä—É—à–∞—Ç –æ—Å–Ω–æ–≤–Ω—É—é –ª–æ–≥–∏–∫—É —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π. –ù–∞ –ø—Ä–∏–º–µ—Ä–µ —à–∞–±–ª–æ–Ω–∞ –º–æ–∂–Ω–æ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å
``BotMenuElemViewSet`` —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä, —Ç–æ –≤ —Å–ø–∏—Å–∫–µ BotMenuElem –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è
—Ç–æ–ª—å–∫–æ —Ç–µ —ç–ª–µ–º–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –≤ —Å–≤–æ–µ–º –ø–æ–ª–µ ``—Åommand`` —É–∫–∞–∑–∞–Ω–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä. –î–ª—è —ç—Ç–æ–≥–æ –Ω–∞–¥–æ –≤–Ω–µ—Å—Ç–∏ —Å–ª–µ–¥—É—é—â–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥:

.. code:: python

    class BotMenuElemViewSet(TelegaViewSet):
        ...

        foreign_filter_amount = 1

        def get_queryset(self):
            queryset = super().get_queryset()
            if self.foreign_filters[0]:
                queryset = queryset.filter(command__contains=self.foreign_filters[0])
            return queryset


–ì–¥–µ foreign_filter_amount –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–Ω–µ—à–Ω–∏—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤. –î–ª—è –≤—ã–∑–æ–≤–∞ –º–µ—Ç–æ–¥–∞ —Å –∑–Ω–∞—á–µ–Ω–∏–µ–º —Ñ–∏–ª—å—Ç—Ä–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ
–∏—Ö —É–∫–∞–∑—ã–≤–∞—Ç—å —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –ø—É—Ç–∏ (utrls): ``"sb/sl&start&2"``, ``"sb/sl&start&2&1"``, ``"sb/sl&hello``.
–°—Ç–æ–∏—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ –µ—Å–ª–∏ –Ω–µ —Ö–æ—Ç–∏–º —É–∫–∞–∑—ã–≤–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä, —Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç –≤ –ø—É—Ç–∏ (utrls): ``"sb/sl&&2"``.

–ù–∞ –ø—Ä—è–º—É—é –∫–æ–Ω—Å—Ç—Ä—É–∏—Ä–æ–≤–∞—Ç—å –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã –≤ –ø—É—Ç—è—Ö (utrls) –Ω–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏, —Ç–∞–∫ –∫–∞–∫ —Ñ—É–Ω–∫—Ü–∏–∏ ``gm_callback_data`` –∏ ``get_utrl_params``
—É–º–µ—é—Ç —Å –Ω–∏–º–∏ —Ä–∞–±–æ—Ç–∞—Ç—å. –í gm_callback_data —Ç–∞–∫–∂–µ –µ—Å—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä ``add_filters`` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é True), –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç
–≤–∫–ª—é—á–∞—Ç—å –ª–∏ –≤ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã–π –ø—É—Ç—å (utrl) —Ñ–∏–ª—å—Ç—Ä—ã –∏–ª–∏ –Ω–µ—Ç. –ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ —Å—Ç–æ–∏—Ç False , —Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤ –∞—Ä–≥—É–º–µ–Ω—Ç–∞—Ö —Ñ—É–Ω–∫—Ü–∏–∏
–≤—Ä—É—á–Ω—É—é —É–∫–∞–∑–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã: ``self.gm_callback_data('show_list', 'start', add_filters=False)``  (—Å–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç ``"sb/sl&start``).
–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–µ–Ω—è—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—É—Ç–µ–π.



–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
++++++++++++++++++++++++++++++++++++++++++

–í ``TelegaViewSet`` –µ—Å—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –º–æ–¥–µ–ª–µ–π:

* ``updating_fields: list`` - —Å–ø–∏—Å–æ–∫ –ø–æ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–Ω–æ –ø–æ–º–µ–Ω—è—Ç—å (–æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –ø—Ä–∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —ç–ª–µ–º–µ–Ω—Ç–∞ (``show_elem``);
* ``show_cancel_updating_button: bool`` - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–Ω–æ–ø–∫—É –æ—Ç–º–µ–Ω—ã –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–æ–ª–µ–π, –∫–æ—Ç–æ—Ä–∞—è –≤–µ–¥–µ—Ç –æ–±—Ä–∞—Ç–Ω–æ –∫ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
—ç–ª–µ–º–µ–Ω—Ç–∞ (``show_elem``);
* ``deleting_with_confirm: bool`` - –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —ç–ª–µ–º–µ–Ω—Ç–∞ —Å–ø—Ä–∞—à–∏–≤–∞—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è;
* ``cancel_adding_button: InlineKeyboardButtonDJ`` - –∫–Ω–æ–ø–∫–∞ –æ—Ç–º–µ–Ω—ã –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —ç–ª–µ–º–µ–Ω—Ç–∞ (–º–µ—Ç–æ–¥ ``create``);
* ``use_name_and_id_in_elem_showing: bool``  - –≤–∫–ª—é—á–∞–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∏ ID —ç–ª–µ–º–µ–Ω—Ç–∞ –ø—Ä–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏ —ç—Ç–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ (–º–µ—Ç–æ–¥—ã ``show_list`` –∏ ``show_elem``);
* ``meta_texts_dict: dict`` - —Å–ª–æ–≤–∞—Ä—å, –∫–æ—Ç–æ—Ä—ã–π —Ö—Ä–∞–Ω–∏—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ç–µ–∫—Å—Ç–∞ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è (—Ç–µ–∫—Å—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤–æ –≤—Å–µ—Ö –º–µ—Ç–æ–¥–∞—Ö);



–û–¥–Ω–∞–∫–æ, —ç—Ç–∏—Ö –ø–æ–ª–µ–π –Ω–µ –≤—Å–µ–≥–¥–∞ —Ö–≤–∞—Ç–∞–µ—Ç –∏ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –ª–æ–≥–∏–∫—É –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è –∫—Ä–∞—Å–∏–≤–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.


–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++


–í –∫–ª–∞—Å—Å–µ ``TelegaViewSet`` –æ–ø–∏—Å–∞–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è:


* ``def generate_message_no_elem`` - –µ—Å–ª–∏ –Ω–µ –±—ã–ª –Ω–∞–π–¥–µ–Ω —ç–ª–µ–º–µ–Ω—Ç —Å —Ç–∞–∫–∏–º ID;
* ``def generate_message_success_created`` - –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º —Å–æ–∑–¥–∞–Ω–∏–∏ –º–æ–¥–µ–ª–∏ ;
* ``def generate_message_next_field`` - –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –∞—Ç—Ä–∏–±—É—Ç —Ñ–æ—Ä–º—ã;
* ``def generate_message_next_field_choice_buttons`` - –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–Ω–æ–ø–∫–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –∞—Ç—Ä–∏–±—É—Ç–∞ —Ñ–æ—Ä–º—ã (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ ``generate_message_next_field``);
* ``def generate_message_value_error`` - –≤—ã–≤–æ–¥ –æ—à–∏–±–∫–∏ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∞—Ç—Ä–∏–±—É—Ç–∞ —Ñ–æ—Ä–º—ã;
* ``def generate_message_self_variant`` - —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –Ω–∞–ø–∏—Å–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –≤—Ä—É—á–Ω—É—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º ;
* ``def generate_show_fields`` - –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –ø–æ–ª—è –º–æ–¥–µ–ª–∏ –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ ``show_elem`` —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º``full_show=True``, –∞ –≤``show_list`` Ôπ£—Å ``full_show=False``);
* ``def generate_value_str`` - –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å—Ç—Ä–æ–∫—É —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –∞—Ç—Ä–∏–±—É—Ç–∞ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ ``generate_show_fields``);
* ``def generate_elem_buttons`` -  –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ (–¥–µ–π—Å—Ç–≤–∏—è) –ø—Ä–∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —ç–ª–µ–º–µ–Ω—Ç–∞ –º–æ–¥–µ–ª–∏ (–≤—ã–∑–æ–≤–µ ``show_elem``) ;
* ``def gm_show_list_button_names`` - –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø—Ä–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏ —Å–ø–∏—Å–∫–∞ (–≤—ã–∑–æ–≤–µ ``show_list``);

–í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–∏ –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è—Ç—å —ç—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏.



–í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –±–∏–∑–Ω–µ—Å –ª–æ–≥–∏–∫–∏
+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

–í –∫–ª–∞—Å—Å–µ ``TelegaViewSet`` –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:

* ``def get_queryset`` - –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫–æ–Ω—Å—Ç—Ä—É–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤ (—á–∞—â–µ –≤—Å–µ–≥–æ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏—Å–ø–æ—å–∑—É–µ—Ç—Å—è, –∫–∞–∫ –≤ –ø—Ä–∏–º–µ—Ä–µ –≤—ã—à–µ);
* ``def create_or_update_helper`` - –æ—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –¥–ª—è ``create`` –∏ ``update`` –º–µ—Ç–æ–¥–æ–≤;
* ``def show_list_get_queryset`` - –ø–æ–∑–≤–æ–ª—è–µ—Ç –∫–∞—Å—Ç–æ–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—ã–±–æ—Ä —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ show_list;




handler_decor
~~~~~~~~~~~~~~~~

–ü—Ä–∏ –Ω–∞–ø–∏—Å–∞–Ω–∏–∏ —Å–≤–æ–∏—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±–µ—Ä—Ç–∫—É –≤ –≤–∏–¥–µ  ``telegram_django_bot.utils.handler_decor``,
–∫–æ—Ç–æ—Ä–∞—è –±–µ—Ä–µ—Ç –Ω–∞ —Å–µ–±—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–ª–µ–¥—É—é—â–∏–π —Ñ—É–Ω–∫—Ü–∏–π:

* –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–ª–∏ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö;
* –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ;
* –õ–æ–≥–≥–∏—Ä—É–µ—Ç –≤—ã–∑–æ–≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞;
* –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –æ—Ç–∫—É–¥–∞ –ø–µ—Ä–µ—à–µ–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å;
* –í—ã–±–æ—Ä —è–∑—ã–∫–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é (–≤ —Å–ª—É—á–∞–µ –≤–∫–ª—é—á–µ–Ω–Ω–æ–π –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏);

–î–∞–Ω–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏ –≤–Ω—É—Ç—Ä–∏ ``RouterCallbackMessageCommandHandler``, —Ç–æ –µ—Å—Ç—å –ø—Ä–∏ –≤—ã–∑–æ–≤–µ ``TelegaViewSet`` –∫–ª–∞—Å—Å–æ–≤.

Localization
~~~~~~~~~~~~~~~~

–í –±–∏–±–∏–ª–æ—Ç–µ–∫–µ —Ä–∞—Å—à–∏—Ä–µ–Ω—ã –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã `–ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏ Django <https://docs.djangoproject.com/en/4.1/topics/i18n/>`_ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –¢–µ–ª–µ–≥—Ä–∞–º–µ.
–î–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–∞–∑–Ω—ã—Ö —è–∑—ã–∫–æ–≤ –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–µ –≤ ``telegram_django_bot.telegram_lib_redefinition`` —Ä–∞—Å—à–∏—Ä—è—é—Ç—Å—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ—Å–Ω–æ–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Python-Telegram-Bot:


1. ``telegram.Bot`` -> ``telegram_django_bot.BotDJ`` ;
2. ``telegram.ReplyMarkup`` -> ``telegram_django_bot.ReplyMarkupDJ`` ;
3. ``telegram.KeyboardButton`` -> ``telegram_django_bot.KeyboardButtonDJ`` ;
4. ``telegram.InlineKeyboardButton`` -> ``telegram_django_bot.InlineKeyboardButtonDJ`` ;
5. ``telegram.InlineKeyboardMarkup`` -> ``telegram_django_bot.InlineKeyboardMarkupDJ``;



–ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ —ç—Ç–∏—Ö –∫–ª–∞—Å—Å–æ–≤ –≤ –∫–æ–¥–µ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —è–∑—ã–∫–æ–≤ —Å–≤–æ–¥–∏—Ç—å—Å—è –∫ —Å–ª–µ–¥—É—é—â–∏–º —à–∞–≥–∞–º:

1. –£–∫–∞–∑–∞–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤ settings: ``LANGUAGES`` - —Å–ø–∏—Å–∫–∞ —è–∑—ã–∫–æ–≤, ``LANGUAGE_CODE`` - —è–∑—ã–∫ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é;
1. –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ç–µ–∫—Å—Ç—ã –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞ –æ–±–µ—Ä—Ç—ã–≤–∞—é—Ç—Å—è –≤ ``gettext`` –∏ ``gettext_lazy`` –∏–∑ ``django.utils.translation`` (–∫–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ Django `–ø–æ—á–∏—Ç–∞—Ç—å —Ç—É—Ç <https://docs.djangoproject.com/en/4.1/topics/i18n/translation/#standard-translation>`_ )
2. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã ``$ django-admin makemessages -a`` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ–∫—Å—Ç–æ–≤ –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞ (—Å–æ–∑–¥–∞—é—Ç—Å—è –≤ –ø–∞–ø–∫–µ locale)
3. –ì–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ñ–∞–π–ª–æ–≤ –ø–µ—Ä–µ–≤–æ–¥–∞ ``$ django-admin compilemessages``.

–î–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –ø–æ–Ω–∏–º–∞–Ω–∏—è –≤ —à–∞–±–ª–æ–Ω–µ —Ç–æ–ª—å–∫–æ —á–∞—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—é. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ
—Ñ—É–Ω–∫—Ü–∏–∏ ``some_debug_func``.





Extra lib features
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

–í –±–∏–±–ª–∏–æ—Ç–µ–∫–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω—ã –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–æ—Ç–æ–º.


–ú–æ–¥–µ–ª–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
************************************


–î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã ``TelegaViewSet`` –∏ –¥—Ä—É–≥–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ, —á—Ç–æ–±—ã –º–æ–¥–µ–ª—å, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∞—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –¢–µ–ª–µ–≥—Ä–∞–º–º–µ, –±—ã–ª–∞ —É–Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∞
–æ—Ç ``telegram_django_bot.models.TelegramUser``, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –µ–µ –ø–æ–ª—è. ``TelegramUser`` —É–Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω –æ—Ç
``django.contrib.auth.models.AbstractUser`` (—á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤—ã–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ —Å–∞–π—Ç–µ) –∏ –∏–º–µ–µ—Ç
—Å–ª–µ–¥—É—é—â–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:

* ``id`` - –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ —Ç–µ–ª–µ–≥—Ä–∞–º–º;
* ``seed_code`` -  –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –æ—Ç 1 –¥–æ 100, —á—Ç–æ–±—ã —Å–ª—É—á–∞–π–Ω–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤ –∏ –∞–Ω–∞–ª–∏–∑–∞;
* ``telegram_username`` - username –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Ç–µ–ª–µ–≥—Ä–∞–º–º–µ;
* ``telegram_language_code`` - –∫–æ–¥ —è–∑—ã–∫–∞ –≤ —Ç–µ–ª–µ–≥—Ä–∞–º–º–µ (–Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —è–∑—ã–∫–∏ –∏–º–µ—é—Ç –Ω–∞—Ä–µ—á–∏—è –∏ –∫–∞–∫ —Å–ª–µ–¥—Å—Ç–≤–∏–µ –∫–æ–¥–æ–≤–æ–µ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏–µ –±–æ–ª—å—à–µ —á–µ–º 2 —Å–∏–º–≤–æ–ª–∞);
* ``timezone`` - —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏);
* ``current_utrl`` - –ø—É—Ç—å (utrl) –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–æ ``TelegaViewSet``);
* ``current_utrl_code_dttm`` - –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è, –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –ø—É—Ç–∏;
* ``current_utrl_context_db`` - –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø—É—Ç–∏ (utrl);
* ``current_utrl_form_db`` - –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ñ–æ—Ä–º—ã. –í—ã—Å—Ç—É–ø–∞–µ—Ç –∫–∞–∫ –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–∏ —Ñ–æ—Ä–º—ã;

–ü–æ–ª—è ``current_utrl_<—Å—É—Ñ—Ñ–∏–∫—Å>`` –Ω—É–∂–Ω—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã ``TelegaViewSet``, ``TelegaModelForm`` –∏ —Å–∫–æ—Ä–µ–π –≤—Å–µ–≥–æ –Ω–µ –Ω—É–∂–Ω—ã –±—É–¥—É—Ç
–ø—Ä–∏ –Ω–∞–ø–∏—Å–∞–Ω–∏–∏ –∫–æ–¥–∞. –¢–∞–∫–∂–µ –º–æ–¥–µ–ª—å –∏–º–µ–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ –º–µ—Ç–æ–¥—ã (property) –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –ø–æ–ª—è–º–∏ –º–æ–¥–µ–ª–∏:

* ``current_utrl_form`` (property) - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—É—â–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã –ø—É—Ç–∏(utrl);
* ``current_utrl_context`` (property) - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—É—â–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø—É—Ç–∏(utrl);
* ``save_form_in_db`` - —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ñ–æ—Ä–º—É –≤ –ø–æ–ª–µ ``current_utrl_form_db``;
* ``save_context_in_db`` - —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤ –ø–æ–ª–µ ``current_utrl_context_db``;
* ``clear_status`` - –æ—á–∏—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–º –ø—É—Ç–µ–º (–ø–æ–ª—è ``current_utrl_<—Å—É—Ñ—Ñ–∏–∫—Å>`) ;
* ``language_code`` (property) - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–¥ —è–∑—ã–∫–∞, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –Ω–∞–¥–æ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é ;


–í –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –æ–ø–∏—Å–∞–Ω—ã –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏ –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —É–¥–æ–±—Å—Ç–≤–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±–æ—Ç–∞:

* ``ActionLog`` - —Ö—Ä–∞–Ω–∏—Ç –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –ó–∞–ø–∏—Å–∏ –ø–æ–º–æ–≥–∞—é—Ç —Å–æ–±–∏—Ä–∞—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫—É –∏ –¥–µ–ª–∞—Ç—å —Ç—Ä–∏–≥–≥–µ—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –ø—Ä–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏—è—Ö;
* ``TeleDeepLink`` - —Ö—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ –∫–∞–∫–∏–º —Å—Å—ã–ª–∫–∞–º –ø–µ—Ä–µ—à–ª–∏ –Ω–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (–¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –≤—Ö–æ–¥–Ω–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞);
* ``BotMenuElem`` - –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —á–∞—Å—Ç–æ –≤ –±–æ—Ç–µ –Ω—É–∂–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –∏–º–µ—é—Ç —Ç–æ–ª—å–∫–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ. –¢–∞–∫–∏–º–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏ –º–æ–≥—É—Ç –±—ã—Ç—å —Ö–µ–ª–ø –∏ —Å—Ç–∞—Ä—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è.
 ``BotMenuElem`` –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å —Ç–∞–∫–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É, –ø—Ä–∏ —ç—Ç–æ–º –Ω–µ –Ω–∞–¥–æ –Ω–∏—á–µ–≥–æ –ø–∏—Å–∞—Ç—å –≤ –∫–æ–¥–µ. –í ``BotMenuElem`` –µ—Å—Ç—å
  –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å—Ç–∞—Ä—Ç–æ–≤—ã—Ö deeplink. ``BotMenuElem`` —É–º–µ–µ—Ç –Ω–µ —Ç–æ–ª—å–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –∫–Ω–æ–ø–∫–∏ –≤ —Å–æ–æ–±—â–µ–Ω–∏–µ, –Ω–æ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å
   —Ä–∞–∑–Ω—ã–µ —Ñ–∞–π–ª—ã. –î–ª—è —ç—Ç–æ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–∫–∞–∑—ã–≤–∞—Ç—å ``media`` –∏ —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞ ``message_format``. ``BotMenuElem`` –ø–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Å—Ç—Ä–æ –º–µ–Ω—è—Ç—å –±–ª–æ–∫–∏ –º–µ–Ω—é –±–æ—Ç–∞ –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤–Ω–æ—Å–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥;
* ``BotMenuElemAttrText`` - –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å –¥–ª—è ``BotMenuElem``, –æ—Ç–≤–µ—á–∞—é—â–∞—è –∑–∞ –ø–µ—Ä–µ–≤–æ–¥ —Ç–µ–∫—Å—Ç–æ–≤ –Ω–∞ –¥—Ä—É–≥–∏–µ —è–∑—ã–∫–∏.
–≠–ª–µ–º–µ–Ω—Ç—ã —Å–∞–º–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —É–∫–∞–∑–∞–Ω–Ω—ã—Ö —è–∑—ã–∫–æ–≤ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö ``LANGUAGES``. –í–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ª–∏—à—å –∑–∞–ø–æ–ª–Ω—è—Ç—å –ø–µ—Ä–µ–≤–æ–¥ –≤ –ø–æ–ª–µ ``translated_text`` ;
* ``Trigger`` - –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —Ç—Ä–∏–≥–≥–µ—Ä—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π. –ù–∞–ø—Ä–∏–º–µ—Ä, –Ω–∞–ø–æ–º–Ω–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, —á—Ç–æ —É –Ω–µ–≥–æ –æ—Å—Ç–∞–ª–∞—Å—è
–Ω–µ–¥–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–π –∑–∞–∫–∞–∑, –∏–ª–∏ –ø–æ–¥–∞—Ä–∏—Ç—å —Å–∫–∏–¥–∫—É, –µ—Å–ª–∏ –æ–Ω –±–µ–∑–¥–µ–π—Å—Ç–≤—É–µ—Ç –¥–æ–ª–≥–æ. –î–ª—è —Ä–∞–±–æ—Ç—ã —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞–Ω–∏—è –∏–∑
telegram_django_bot.tasks.create_triggers –≤ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ CeleryBeat;
* ``UserTrigger`` - –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å –¥–ª—è ``Trigger``, –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É—é—â–∞—è –∫–æ–º—É —É–∂–µ –±—ã–ª–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã —Ç—Ä–∏–≥–≥–µ—Ä—ã;





–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ TG_DJ_Bot
*********************************************

–î–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —É–¥–æ–±—Å—Ç–≤–∞ ``TG_DJ_Bot`` –æ–±–ª–∞–¥–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏—è–º–∏:

* ``send_format_message`` - –ü–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ —Ç–∏–ø–∞ (–≤–Ω—É—Ç—Ä–∏ —Å–µ–±—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç ``message_format`` –ø–æ–¥–±–∏—Ä–∞–µ—Ç –Ω—É–∂–Ω—ã–π –º–µ—Ç–æ–¥ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ ``Python-Telegram-Bot``).
–í–∞–∂–Ω–æ–π –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π —è–≤–ª—è–µ—Ç—Å—è —Ç–æ, —á—Ç–æ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∞–ª –Ω–∞ –∫–Ω–æ–ø–∫—É, —Ç–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç–∞ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è, –∞ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –Ω–æ–≤–æ–µ.
–ï—Å–ª–∏ –∂–µ –≤—Å–µ-—Ç–∞–∫–∏ –≤ —ç—Ç–æ–º –∫–µ–π—Å–µ –Ω–∞–¥–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, —Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä ``only_send=True`` ;
* ``edit_or_send`` - –æ–±–µ—Ä—Ç–∫–∞ –º–µ—Ç–æ–¥–∞ ``send_format_message`` –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π —Å –∫–Ω–æ–ø–∫–∞–º–∏;
* ``send_botmenuelem`` - –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —ç–ª–µ–º–µ–Ω—Ç ``BotMenuElem`` –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é. –ê—Ä–≥—É–º–µ–Ω—Ç ``update`` –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º;
* ``task_send_message_handler`` - —Å–æ–∑–¥–∞–Ω –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–∏—Ç—É–∞—Ü–∏–∏, –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª –±–æ—Ç–∞, —É–¥–∞–ª–µ–Ω –∏–ª–∏ –∫–æ–≥–¥–∞ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –ø—Ä–µ–¥–µ–ª –ø–æ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º;


Utils
**********

–í –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:


* ``telegram_django_bot.utils.add_log_action`` - –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è ActionLog –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è;
* ``telegram_django_bot.utils.CalendarPagination`` - –∫–ª–∞—Å—Å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–∞–ª–µ–Ω–¥–∞—Ä—è —Å –∫–Ω–æ–ø–∫–∞–º–∏;
* ``telegram_django_bot.user_viewset.UserViewSet`` - –∫–ª–∞—Å—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ç–µ–ª–µ–≥—Ä–∞–º –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —è–∑—ã–∫–∞ –∏ —á–∞—Å–æ–≤–æ–≥–æ –ø–æ—è—Å–∞;


Mapping details
********************

–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ —á—É—Ç—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ —Ä–∞–∑–±–µ—Ä–µ–º —Ä–∞–±–æ—Ç—É ``RouterCallbackMessageCommandHandler`` –∏ ``telega_reverse``.

–ö–∞–∫ –æ–ø–∏—Å—ã–≤–∞–ª–æ—Å—å —Ä–∞–Ω–µ–µ ``RouterCallbackMessageCommandHandler`` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –Ω–∞–ø–∏—Å–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤ —Å—Ç–∏–ª–µ
Django. –¢–∞–∫–∂–µ ``RouterCallbackMessageCommandHandler`` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –≤—ã–∑–æ–≤—ã ``BotMenuElem`` –∫–∞–∫
—á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—ã, —Ç–∞–∫ –∏ —á–µ—Ä–µ–∑ callback. –≠—Ç–æ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç—Å—è –∑–∞ —Å—á–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π ``all_command_bme_handler`` –∏
``all_callback_bme_handler``. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–∑–æ–≤–æ–≤  ``BotMenuElem`` –≤–∫–ª—é—á–µ–Ω–∞ –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫
–Ω–µ –±—ã–ª–æ –Ω–∞–π–¥–µ–Ω–æ –ø–æ–¥—Ö–æ–¥—è—â–µ–≥–æ –ø—É—Ç–∏ –≤ –æ–ø–∏—Å–∞–Ω–∏–∏ utrls (–ø—É—Ç–µ–π –≤ Django –Ω–æ—Ç–∞—Ü–∏–∏). –ï—Å–ª–∏ —Å—Ä–µ–¥–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ ``BotMenuElem`` –Ω–µ –±—ã–ª–æ
–Ω–∞–π–¥–µ–Ω–æ –ø–æ–¥—Ö–æ–¥—è—â–µ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞, —Ç–æ —Å—á–∏—Ç–∞–µ—Ç—Å—è, —á—Ç–æ ``BotMenuElem`` –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –Ω–µ–≤–µ—Ä–Ω–æ. –û—Ç–∫–ª—é—á–∏—Ç—å –≤—ã–∑–æ–≤—ã ``BotMenuElem``
–º–æ–∂–Ω–æ —Å–æ–∑–¥–∞–Ω–∏–µ–º –∫–ª–∞—Å—Å–∞ —Å –∞—Ç—Ä–∏–±—É—Ç–æ–º ``only_utrl=True``.

–í —à–∞–±–ª–æ–Ω–µ-–ø—Ä–∏–º–µ—Ä–µ –µ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ ``telega_reverse``, —Å—É—Ç—å –∫–æ—Ç–æ—Ä–æ–π –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—É—Ç–∏ (—Å—Ç—Ä–æ–∫–∏) –¥–æ
–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞, –∫–æ—Ç–æ—Ä—ã–π —É–∫–∞–∑–∞–Ω –≤ –∞—Ä–≥—É–º–µ–Ω—Ç–µ —Ñ—É–Ω–∫—Ü–∏–∏. –§—É–Ω–∫—Ü–∏—è —è–≤–ª—è–µ—Ç—Å—è –∞–Ω–∞–ª–æ–≥–æ–º `reverse <https://docs.djangoproject.com/en/4.1/ref/urlresolvers/#reverse>`_ —Ñ—É–Ω–∫—Ü–∏–∏ Django
–∏ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑–±–µ–≥–∞—Ç—å –æ—à–∏–±–æ–∫ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø—É—Ç–µ–π.




–¢–µ—Å—Ç—ã
**********************

–í –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ —Ç–∞–∫–∂–µ —Ä–∞—Å—à–∏—Ä–µ–Ω—ã –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ ``django.test.TestCase`` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å –¢–µ–ª–µ–≥—Ä–∞–º–º–æ–º –∑–∞ —Å—á–µ—Ç –∫–ª–∞—Å—Å–∞ ``TD_TestCase``.

–ù–∞–∏–±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç–æ–π –ø–æ–¥—Ö–æ–¥ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞ —è–≤–ª—è–µ—Ç—Å—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –æ–∂–∏–¥–∞–µ—Ç –±–æ—Ç –æ—Ç –¢–µ–ª–µ–≥—Ä–∞–º–º–∞ –∏
–æ—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–≤–µ—Ç–∞ –≤ –¢–µ–ª–µ–≥—Ä–∞–º (–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, —á—Ç–æ –æ—Ç–≤–µ—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –±–æ—Ç–∞ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ). –ö–ª–∞—Å—Å ``TD_TestCase``
–∏–º–µ–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é ``create_update`` –¥–ª—è –ø—Ä–æ—Å—Ç–æ–≥–æ –∏ –±—ã—Å—Ç—Ä–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è ``Telegram.Update``, –∫–æ—Ç–æ—Ä—ã–π –∫–∞–∫ —Ä–∞–∑ –∏ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å
–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ç–µ–ª–µ–≥—Ä–∞–º–º–∞. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –æ–±—â–∏–π –¥–∏–∑–∞–π–Ω –≤—ã–≥–ª—è–¥–∏—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

1. –°–æ–∑–¥–∞–µ—Ç—Å—è ``Telegram.Update``, —ç–º—É–ª–∏—Ä—É—é—â–∏–π –∑–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è;
2. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º—ã—Ö –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –¢–µ–ª–µ–≥—Ä–∞–º (–∑–∞ —Å—á–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π —Ç–µ—Å—Ç–æ–≤—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º);
3. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –±–¥ –∑–∞ —Å—á–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ ``django.test.TestCase``.


–î–ª—è —Ä–∞–±–æ—Ç—ã —Ç–µ—Å—Ç–æ–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É–∫–∞–∑–∞—Ç—å –∫–∞–∫ –º–∏–Ω–∏–º—É–º –æ–¥–∏–Ω ID —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Ä–∞–∑–¥–µ–ª–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ ``TELEGRAM_TEST_USER_IDS``.
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –±—É–¥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è, –ø–æ—ç—Ç–æ–º—É –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ, —á—Ç–æ–±—ã —É –±–æ—Ç–∞ –±—ã–ª–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç–æ–≤–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.

